# Deployment
Инструменты сборки и разворачивания продуктов

## Генерация ssh-ключей

Для генерации ключей для CircleCI применяется скрипт

**keygenerator.sh**

После генерации создается папка с указанным названием, ssh-ключи (приватный и публичный), зашифрованный zip-архив с приватным ключем и текстовый файл с ключами для расшифровки архива.

## Создание пустой базы и нового пользователя БД

Для подготовки пустой базы под проект используется скрипт:

**mysqlpreparing.sh**

Скрипт создает пустую базу с указанным названием, нового пользователя с уровнем *ALL PRIVILEGES* к этой базе.
После генерации выведет в консоль имя новой базы, имя нового пользователя и его пароль.

## Включение нотификаций из CircleCI в Discord

В файл конфигурации для CircleCI внесена отправка кастомных уведомлений в Discord:

**.circleci/config.yml**

Для успешной работы конфига нужно добавить в настройки CircleCI необходимые Enviroment Variables:

* **notification_discord_webhook** – вебхук канала оповещений Discord
* **notification_success_message**, **notification_fail_message** – текстовые сообщения успешной и проваленой сборки

## Настройка уведомлений GitHub в Discord

Для отправки уведомлений в дискорд необходимо создать вебхук канала, а ссылку на вебхук вставить в настройках репозитория в подразделе Webhooks.

Для этого необходимо создать вебхук в GitHub, и в поле **Payload URL** вставить ссылку на вебхук канала дискорда. В конец строки дописать **/github**.

Выбрать для **Content type** значение **application/json**, а **Secret** оставить пустым.

Далее, рекомендуется выбрать оповещения, которые должен присылать GitHub. Для этого в разделе **Which events would you like to trigger this webhook?** нужно выбрать **Let me select individual events** и указать следующие флаги:
* **Commit comments** – комментарии к коммитам;
* **Branch or tag creation** – создание ветки или тэга;
* **Branch or tag deletion** - удаление ветки или тэга;
* **Forks** - полезно знать, когда кто-то делает форк;
* **Issue comments** - комментарии к коммитам в пулл-реквестах во время код-ревью;
* **Pull requests** - когда кто-то создает пул-реквесты;
* **Pull request reviews** - комментарии к пулл-реквестам;
* **Pushes** - уведомления о коммитах;
* **Releases** - полезно знать, когда собрали релиз продукта;
* **Repository vulnerability alerts** - будет ползно знать об уязвимостях с точки зрения гитхаба.



---

To be continue..
